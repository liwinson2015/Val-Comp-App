/* Losers bracket: aligned like a real tournament bracket, centered & scaled */

.lbViewport{
  --colw: clamp(120px, 9vw, 160px);
  --gap:  clamp(18px, 2.2vw, 26px);

  /* slot + match geometry */
  --slotH: 40px;           /* medium height, a bit flat */
  --pairGapInside: 10px;   /* gap between top/bottom slots of one match */
  --pairPad: 4px;

  /* total height of a match block (two slots) */
  --pairH: calc(var(--slotH)*2 + var(--pairGapInside) + var(--pairPad)*2);

  /* base spacing: distance between matches in the FIRST round */
  --r1Space: 24px;         /* vertical gap between R1 matches */

  /* for formulas later */
  --line: #2a2f36;
  --joinW: 2px;
  --stub: 10px;
  --arm:  calc(var(--gap) - var(--stub));

  /* light slots for now (we can restyle later) */
  --slotBg: #f5f7fb;
  --slotBorder: #cfd7ea;
  --textDark: #0f1320;

  --stageW: calc(var(--colw) * 7 + var(--gap) * 6);
  --stageH: clamp(520px, 62vh, 720px);

  --topSpace: 120px;
  --fitW: calc(100vw / var(--stageW));
  --fitH: calc((100vh - var(--topSpace)) / var(--stageH));
  --scale: min(1, var(--fitW), var(--fitH));

  width:100%;
  height:calc(100vh - var(--topSpace));
  display:grid;
  place-items:center;
  overflow:visible;
}

.lbStage{
  width:var(--stageW);
  height:var(--stageH);
  transform:scale(var(--scale));
  transform-origin:top center;
}

.lbGrid{
  width:100%;
  height:100%;
  display:grid;
  grid-template-columns:repeat(7,var(--colw));
  gap:var(--gap);
  align-items:start;
}

/* rounds / titles */

.round{ position:relative; }

.roundTitle{
  color:#dfe6f3;
  font-weight:900;
  font-size:12px;
  letter-spacing:.08em;
  text-transform:uppercase;
  margin-bottom:8px;
}

.stack{
  position:relative;
  display:grid;
}

/* ---------- vertical spacing logic ---------- */
/* R1: base rhythm. Distance between match centers = pairH + r1Space */

.r1 .pair{
  margin: calc(var(--r1Space)/2) 0;
}

/* R2: same rhythm as R1, but the entire column is shifted down by
   half of one "center-to-center" distance so each R2 match sits
   BETWEEN the two R1 matches that feed it. */
.r2 .pair{
  margin: calc(var(--r1Space)/2) 0; /* same D as R1 */
}
/* shift R2 down by (pairH + r1Space)/2 */
.r2 .stack{
  margin-top: calc( (var(--pairH) + var(--r1Space)) / 2 );
}

/* R3A & R3B: they are fed by R2. We use the same base rhythm, but
   shift them further down by one full "step" so visually they sit
   under the correct groups of R2 matches. */
.r3a .pair,
.r3b .pair{
  margin: calc(var(--r1Space)/2) 0;
}
.r3a .stack,
.r3b .stack{
  margin-top: calc( var(--pairH) + var(--r1Space) );
}

/* R4 + LB Final: single matches fed by previous rounds.
   They follow the same general offset as R3 to keep everything
   visually grouped. You can tweak these later if you want a
   slightly higher/lower position. */
.r4 .pair,
.rFinal .pair{
  margin: calc(var(--r1Space)/2) 0;
}
.r4 .stack,
.rFinal .stack{
  margin-top: calc( var(--pairH) + var(--r1Space) );
}

/* ---------- match boxes + connectors ---------- */

.pair{
  position:relative;
  padding: var(--pairPad) 0;
}

/* small horizontal stub on the right connecting to the next column */
.pair::after{
  content:"";
  position:absolute;
  top:50%;
  right: calc(var(--stub) * -1);
  transform: translateY(-50%);
  width: var(--stub);
  height: var(--joinW);
  background: var(--line);
}

.slot{
  height: var(--slotH);
  border: 2px solid var(--slotBorder);
  border-radius: 0;
  background: var(--slotBg);
  display:flex;
  align-items:center;
  justify-content:center;
  padding: 0 10px;
  box-shadow: none;
  text-align: center;
}

.slot + .slot{
  margin-top: var(--pairGapInside);
}

.label{
  color: var(--textDark);
  font-weight: 700;
  font-size: 13px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* vertical collectors + arms from previous column */

.r2 .pair,
.r3a .pair,
.r3b .pair,
.r4 .pair,
.rFinal .pair{
  background-image:
    linear-gradient(var(--line), var(--line)),
    linear-gradient(var(--line), var(--line));
  background-repeat: no-repeat, no-repeat;
  background-size:
    var(--joinW) calc(var(--slotH) + var(--pairGapInside)),
    var(--arm) var(--joinW);
  background-position:
    left calc(var(--gap) * -1 + var(--arm)) 50%,
    left calc(var(--gap) * -1)              50%;
}

/* ---------- LB winner pill ---------- */

.lbWinnerCol{
  display:flex;
  flex-direction:column;
  align-items:flex-start;
}

.lbWinnerTitle{
  color:#dfe6f3;
  font-weight:900;
  font-size:12px;
  letter-spacing:.08em;
  text-transform:uppercase;
  margin-bottom:8px;
}

.lbWinnerPill{
  min-width: var(--colw);
  background:#1c2952;
  border:2px solid #122040;
  color:#ffffff;
  border-radius:8px;
  padding:10px 16px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.lbWinnerText{
  font-weight:800;
}
